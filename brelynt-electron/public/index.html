<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BrelyntOS ‚Äî –ú–∏–Ω–∏-–ø—Ä–æ—Ç–æ—Ç–∏–ø</title>
  <style>
    body {
      background: #181818; color: #ededed;
      font-family: 'Segoe UI', Arial, sans-serif; margin: 0;
    }
    h1 {
      font-size: 2.45em; text-align: center; margin: 48px 0 30px 0;
      font-weight: 900; letter-spacing: 1px; color: #ededed;
    }
    h2 { font-size: 1.32em; font-weight: 800; margin: 22px 0 12px 0; }
    .toolbar {
      position: absolute; top: 18px; right: 32px; display: flex; gap: 12px;
    }
    .toolbar-btn {
      background: #222; color: #ededed; border: none;
      font-size: 1.16em; font-weight: 500;
      padding: 9px 22px; border-radius: 9px; cursor: pointer;
      transition: background 0.15s;
      display: flex; align-items: center; justify-content: center;
      min-width: 44px; min-height: 44px;
      outline: none;
    }
    .toolbar-btn:focus, .toolbar-btn:hover { background: #232323; }
    .main-menu { display: flex; flex-direction: column; align-items: center; margin-top: 26px; gap: 24px;}
    .section-btn {
      width: 430px; background: #232323; border: none; border-radius: 16px;
      color: #ededed; padding: 21px 34px 15px 34px; text-align: left; cursor: pointer;
      box-sizing: border-box; margin: 0; transition: background 0.13s;
      font-size: 1.18em; font-weight: 800; letter-spacing: 0.02em;
      display: flex; flex-direction: column; align-items: flex-start;
    }
    .section-btn .section-desc { font-size: .91em; font-weight: 400; color: #b9b9b9; margin-top: 3px; }
    .section-btn:hover, .section-btn:focus { background: #1b1b1b; }
    .admin-panel {
      background: #222; padding: 14px 24px 20px 18px; border-radius: 12px;
      margin: 28px 0 0 0; color: #ededed; font-size: 1em; max-width: 540px;
      box-shadow: 0 2px 14px #000a;
    }
    .admin-btn { background: none; border: none; color: #ededed; cursor: pointer; font-size: 1em; }
    .admin-btn:focus, .admin-btn:hover { color: #fff; text-decoration: underline;}
    .modal { display: none; position: fixed; top:0; left:0; width:100vw; height:100vh; background:#000b; align-items:center; justify-content:center; z-index:99;}
    .modal.open { display: flex;}
    .modal-content { background:#232323; padding:40px 34px 26px 34px; border-radius:18px; color:#ededed; max-width:460px;}
    .modal-content textarea { width: 99%; min-height: 90px; background: #1b1b1b; color: #ededed; border: 1px solid #444; border-radius: 6px; padding: 8px; margin-top: 6px;}
    .modal-content input { width: 99%; background: #1b1b1b; color: #ededed; border: 1px solid #444; border-radius: 6px; padding: 7px; margin-top: 6px; }
    .modal-content .modal-actions { margin-top: 20px; display: flex; gap: 18px; justify-content: flex-end;}
    .breadcrumbs { font-size: 0.68em; color: #bbb; margin: 0 0 11px 44px; padding: 0;}
    .breadcrumbs span { color: #ededed; }
    .breadcrumbs a { color: #bbb; text-decoration: none; }
    .breadcrumbs a:hover { text-decoration: underline; color: #ededed;}
    .pay-btns { display: flex; flex-direction: column; gap: 16px; margin: 25px 0 20px 0;}
    .pay-btn {
      background: #232323; color: #ededed; border: none; border-radius: 9px;
      padding: 14px 0; font-size: 1.12em; font-weight:800;
      cursor:pointer; width: 100%; text-align: center;
      outline: none; transition: background 0.13s;
    }
    .pay-btn.selected, .pay-btn:focus { background: #ededed; color: #181818; }
    .pay-btn:hover { background: #292929; color: #fff;}
    .copy-btn { font-size: 0.96em; background: #232323; color: #ededed; border: none; cursor: pointer; margin-left: 7px; border-radius: 7px; padding: 4px 15px;}
    .copy-btn:hover, .copy-btn:focus { background: #2c2c2c; color: #fff; }
    .pay-data {
      margin: 18px 0 10px 0; font-size: 1em; word-break: break-all;
      background: #222; border-radius: 10px; padding: 19px 18px 12px 20px;
      box-shadow: 0 2px 11px #0008;
    }
    .pay-note { color: #a7a7a7; font-size: .95em; margin-top: 2px;}
    .edit-bar {margin-top: 18px;display:flex;gap:20px;}
    .edit-bar button {background:none;color:#ededed;border:none;cursor:pointer;font-size:.96em;}
    .edit-bar button:hover, .edit-bar button:focus {text-decoration: underline;}
    .lang-panel { text-align: center; margin-top: 55px; color: #aaa; font-size: .93em;}
    .lang-panel a {
      display: inline-block; margin: 6px 7px; padding: 4px 14px;
      border-radius: 8px; color: #ededed; text-decoration: none;
      background: #292929; transition: background 0.13s;
      font-weight: 600; font-size: .98em;
    }
    .lang-panel a:hover, .lang-panel a.selected { background: #ededed; color: #181818;}
    .lang-panel .small-note {display:block;margin-top:10px;color:#777;font-size:.91em;}
    @media (max-width: 700px) {
      .section-btn { width: 98vw; min-width: unset; padding-left: 7vw; padding-right: 7vw;}
      .admin-panel { max-width: unset; }
      .toolbar { right: 12px; top: 8px;}
      h1 { margin-top: 36px; }
      .breadcrumbs { margin-left: 2vw;}
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <button class="toolbar-btn" onclick="showLangPanel()" title="EN ‚Äî –Ø–∑—ã–∫">EN</button>
    <button class="toolbar-btn" onclick="showThemeInfo()" title="–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è">&#9675;</button>
    <button class="toolbar-btn" onclick="showSettingsInfo()" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">&#9881;</button>
    <button class="toolbar-btn" onclick="toggleAdmin()" id="adminSwitch">–í–æ–π—Ç–∏ –∫–∞–∫ –ê–¥–º–∏–Ω</button>
  </div>
  <h1 id="header">BrelyntOS</h1>
  <div class="breadcrumbs" id="breadcrumbs" style="display:none"></div>
  <div class="main-menu" id="mainMenu"></div>
  <div id="sectionPage" style="display:none"></div>
  <div class="lang-panel" id="langPanel" style="display:none;">
    <b>–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:</b><br>
    <a href="#" onclick="selectLang('ru');return false;">RU</a>
    <a href="#" onclick="selectLang('cz');return false;">CZ</a>
    <a href="#" onclick="selectLang('en');return false;" class="selected">EN</a>
    <a href="#" onclick="selectLang('de');return false;">DE</a>
    <a href="#" onclick="selectLang('es');return false;">ES</a>
    <span class="small-note">–ü–æ–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∏</span>
  </div>
  <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ ‚Äî –∫–∞–∫ –ø—Ä–µ–∂–¥–µ -->
  <div class="modal" id="editModal">
    <div class="modal-content">
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞:<br>
        <input id="sectionTitleInput" maxlength="40">
      </label>
      <label style="margin-top:14px;">–û–ø–∏—Å–∞–Ω–∏–µ:<br>
        <textarea id="sectionDescInput" rows="4"></textarea>
      </label>
      <div class="modal-actions">
        <button type="button" onclick="closeModal('editModal')">–û—Ç–º–µ–Ω–∞</button>
        <button type="button" onclick="saveSectionEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
  <div class="modal" id="addModal">
    <div class="modal-content">
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞:<br>
        <input id="addTitleInput" maxlength="40">
      </label>
      <label style="margin-top:14px;">–û–ø–∏—Å–∞–Ω–∏–µ:<br>
        <textarea id="addDescInput" rows="3"></textarea>
      </label>
      <div class="modal-actions">
        <button type="button" onclick="closeModal('addModal')">–û—Ç–º–µ–Ω–∞</button>
        <button type="button" onclick="saveAddSection()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>
  <div class="modal" id="walletEditModal">
    <div class="modal-content">
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã:<br><input id="payTitleInput" maxlength="24"></label>
      <label>–†–µ–∫–≤–∏–∑–∏—Ç—ã (–∞–¥—Ä–µ—Å, –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –∏ —Ç.–ø.):<br><textarea id="payRekvInput" rows="2"></textarea></label>
      <label>–°—Å—ã–ª–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞):<br><input id="payLinkInput"></label>
      <div class="modal-actions">
        <button type="button" onclick="closeModal('walletEditModal')">–û—Ç–º–µ–Ω–∞</button>
        <button type="button" onclick="saveWalletMethod()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
  <script>
    // ----- –î–ê–ù–ù–´–ï -----
    const defaultSections = [
      { key: 'wallet', title: '–ö–æ—à–µ–ª—ë–∫', desc: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏, –±–∞–ª–∞–Ω—Å, –ø–µ—Ä–µ–≤–æ–¥—ã, –∏—Å—Ç–æ—Ä–∏—è, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä',
        modules: [
          { type: 'buy', title: '–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞', desc: '–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ BTC, ETH, PayPal, QR-–∫–æ–¥ –∏ –¥—Ä.',
            payMethods: [
              {title: 'BTC', rekv: '1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa', link: '', note: '–î–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏–∑ –†–§ –∏ –º–∏—Ä–∞'},
              {title: '–≠—Ñ–∏—Ä', rekv: '0x1246feEE...', link: '', note: 'ERC-20'},
              {title: 'PayPal', rekv: 'pay@yourdomain.com', link: '', note: '–¢–æ–ª—å–∫–æ –¥–ª—è EUR, USD'},
              {title: '–ö–∞—Ä—Ç–∞', rekv: '**** **** **** 5678', link: '', note: '–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É –ª—é–±–æ–≥–æ –±–∞–Ω–∫–∞'},
              {title: 'QR kod', rekv: 'https://revolut.me/alrxeyok6l', link: 'https://revolut.me/alrxeyok6l', note: '–ü–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ.'}
            ]
          },
          // –ú–æ–¥—É–ª—å –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
          { type: 'history', title: '–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π', desc: '–í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∏ –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Ç–æ–∫–µ–Ω–æ–≤.' }
        ]
      },
      { key: 'cloud', title: 'P2P Cloud', desc: '–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, backup —Ñ—É–Ω–∫—Ü–∏–∏', modules: [] },
      { key: 'faq', title: 'FAQ', desc: '–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –æ—Ç–≤–µ—Ç—ã', modules: [] }
    ];
    let sections = JSON.parse(localStorage.getItem('brelynt-sections') || 'null') || defaultSections;
    let adminMode = false;
    let editingSectionKey = null;
    let editingModuleIndex = null;
    let editingPayIndex = null;
    let navStack = [];

    // ----- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -----
    function renderMenu() {
      document.getElementById('header').textContent = 'BrelyntOS';
      document.getElementById('breadcrumbs').style.display = 'none';
      document.getElementById('mainMenu').style.display = 'flex';
      document.getElementById('mainMenu').innerHTML = '';
      document.getElementById('sectionPage').style.display = 'none';
      document.getElementById('langPanel').style.display = 'none';
      let html = '';
      sections.forEach(sec => {
        html += `<button class="section-btn" onclick="openSection('${sec.key}')">
            <span>${sec.title}</span>
            <span class="section-desc">${sec.desc}</span>
          </button>`;
      });
      if (adminMode) {
        html += `<button class="section-btn" onclick="openAddModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª</button>`;
      }
      document.getElementById('mainMenu').innerHTML = html;
    }

    // ----- –†–ê–ó–î–ï–õ -----
    function openSection(key) {
      let sec = sections.find(s => s.key === key);
      if (!sec) return;
      navStack = [{ title: '–ì–ª–∞–≤–Ω–∞—è', cb: renderMenu }, { title: sec.title, cb: () => openSection(key) }];
      renderSection(sec);
    }
    function renderSection(sec) {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('sectionPage').style.display = 'block';
      document.getElementById('langPanel').style.display = 'none';
      renderBreadcrumbs();
      let html = `<h2>${sec.title}</h2>
        <div class="section-desc" style="margin-bottom:15px;">${sec.desc || ''}</div>`;
      (sec.modules||[]).forEach((mod,i) => {
        if (mod.type === 'buy') {
          html += `<div class="admin-panel"><b style="font-size:1.05em;">${mod.title}</b>
            <div style="margin:10px 0 12px 0; color:#bcbcbc; font-size:.98em;">${mod.desc || ''}</div>
            <div id="payBtns">${renderPayBtns(sec.key,i,mod.payMethods)}</div>
            ${adminMode ? `<div class="edit-bar">
              <button onclick="openPayEditModal('${sec.key}',${i},-1)">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</button>
            </div>` : ''}
          </div>`;
        }
        // –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        if (mod.type === 'history') {
          html += renderHistoryModule(sec, i);
        }
      });
      if (adminMode) {
        html += `<div class="edit-bar" style="margin-top:24px;">
          <button onclick="openSectionEditModal('${sec.key}')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª</button>
          <button onclick="deleteSection('${sec.key}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª</button>
        </div>`;
      }
      html += `<button class="section-btn" onclick="goBack()" style="width:180px;margin:30px auto 0 auto; font-size:1.12em;">–ù–∞–∑–∞–¥</button>`;
      document.getElementById('sectionPage').innerHTML = html;
    }

    function renderPayBtns(sectionKey,modIndex,payMethods) {
      let html = `<div class="pay-btns">`;
      payMethods.forEach((pay, idx) => {
        html += `<button class="pay-btn" onclick="showPayData('${sectionKey}',${modIndex},${idx})">${pay.title}</button>`;
      });
      html += `</div>`;
      return html;
    }

    function showPayData(sectionKey,modIndex,payIndex) {
      let sec = sections.find(s=>s.key===sectionKey);
      if (!sec) return;
      let mod = sec.modules[modIndex];
      let pay = mod.payMethods[payIndex];
      navStack.push({title: pay.title, cb: ()=>showPayData(sectionKey,modIndex,payIndex)});
      renderBreadcrumbs();
      let html = `<div class="pay-data"><b>${pay.title}:</b> ${pay.rekv?pay.rekv:''}
        ${pay.link ? `<div style="margin-top:3px;"><a href="${pay.link}" target="_blank" style="color:#ededed;text-decoration:underline;">–û—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É</a></div>` : ''}
        ${pay.rekv ? `<br><button class="copy-btn" onclick="copyToClipboard('${pay.rekv}')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã</button>` : ''}
        ${pay.note?`<div class="pay-note">${pay.note}</div>`:''}
        </div>`;
      html += `<button class="section-btn" onclick="goBack()" style="width:160px;margin:30px auto 0 auto;font-size:1.07em;">–ù–∞–∑–∞–¥</button>`;
      if (adminMode) {
        html += `<div class="edit-bar" style="margin-top:19px;">
          <button onclick="openPayEditModal('${sectionKey}',${modIndex},${payIndex})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
          <button onclick="deletePayMethod('${sectionKey}',${modIndex},${payIndex})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
        </div>`;
      }
      document.getElementById('sectionPage').innerHTML = html;
    }

    // –ú–æ–¥—É–ª—å ‚Äú–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π‚Äù
    function renderHistoryModule(sec, modIndex) {
      let txs = JSON.parse(localStorage.getItem('brelynt-tx') || '[]');
      let html = `
        <div class="admin-panel">
          <b style="font-size:1.05em;">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</b>
          <div style="margin:10px 0 12px 0; color:#bcbcbc; font-size:.98em;">–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞</div>
          <table style="width:100%;font-size:.97em;">
            <tr>
              <th>–î–∞—Ç–∞</th><th>–¢–∏–ø</th><th>–°—É–º–º–∞</th><th>–ê–¥—Ä–µ—Å</th><th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            </tr>
            ${txs.length ? txs.map(tx => `
              <tr>
                <td>${tx.date || ''}</td>
                <td>${tx.type || ''}</td>
                <td>${tx.amount || ''}</td>
                <td>${tx.address || ''}</td>
                <td>${tx.comment || ''}</td>
              </tr>
            `).join('') : '<tr><td colspan="5" style="text-align:center;color:#aaa;">–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</td></tr>'}
          </table>
          ${adminMode ? `
            <div class="edit-bar" style="margin-top:20px;">
              <button onclick="addTestTx()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</button>
              <button onclick="clearAllTxs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
            </div>
          ` : ''}
        </div>
      `;
      return html;
    }
    // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤:
    window.addTestTx = function() {
      let txs = JSON.parse(localStorage.getItem('brelynt-tx') || '[]');
      txs.push({
        date: (new Date()).toLocaleString(),
        type: Math.random() > 0.5 ? '–ü—Ä–∏—Ö–æ–¥' : '–†–∞—Å—Ö–æ–¥',
        amount: (Math.random() * 100).toFixed(2),
        address: '0xTEST' + Math.floor(Math.random() * 10000),
        comment: '–¢–µ—Å—Ç'
      });
      localStorage.setItem('brelynt-tx', JSON.stringify(txs));
      renderSection(sections.find(s => s.key === 'wallet'));
    };
    window.clearAllTxs = function() {
      if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?')) {
        localStorage.removeItem('brelynt-tx');
        renderSection(sections.find(s => s.key === 'wallet'));
      }
    };

    // ----- –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ -----
    function toggleAdmin() {
      adminMode = !adminMode;
      document.getElementById('adminSwitch').textContent = adminMode ? "–í—ã–π—Ç–∏ –∏–∑ –ê–¥–º–∏–Ω–∞" : "–í–æ–π—Ç–∏ –∫–∞–∫ –ê–¥–º–∏–Ω";
      renderMenu();
    }
    function openSectionEditModal(key) {
      editingSectionKey = key;
      let sec = sections.find(s=>s.key===key);
      document.getElementById('sectionTitleInput').value = sec.title;
      document.getElementById('sectionDescInput').value = sec.desc || '';
      openModal('editModal');
    }
    function saveSectionEdit() {
      let sec = sections.find(s=>s.key===editingSectionKey);
      sec.title = document.getElementById('sectionTitleInput').value.trim()||'–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
      sec.desc = document.getElementById('sectionDescInput').value.trim();
      saveSections();
      closeModal('editModal');
      renderSection(sec);
    }
    function openAddModal() {
      document.getElementById('addTitleInput').value = '';
      document.getElementById('addDescInput').value = '';
      openModal('addModal');
    }
    function saveAddSection() {
      let title = document.getElementById('addTitleInput').value.trim() || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
      let desc = document.getElementById('addDescInput').value.trim();
      let newKey = 'section' + Date.now();
      sections.push({key:newKey, title, desc, modules:[]});
      saveSections();
      closeModal('addModal');
      renderMenu();
    }
    function deleteSection(key) {
      if (!confirm('–£–¥–∞–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª?')) return;
      sections = sections.filter(s=>s.key!==key);
      saveSections();
      renderMenu();
    }

    // --- –ú–æ–¥—É–ª–∏ –∫–æ—à–µ–ª—å–∫–∞ ---
    function openPayEditModal(sectionKey,modIndex,payIndex) {
      editingSectionKey = sectionKey;
      editingModuleIndex = modIndex;
      editingPayIndex = payIndex;
      let sec = sections.find(s=>s.key===sectionKey);
      let pay = (payIndex>-1) ? sec.modules[modIndex].payMethods[payIndex] : {title:'',rekv:'',link:'',note:''};
      document.getElementById('payTitleInput').value = pay.title;
      document.getElementById('payRekvInput').value = pay.rekv;
      document.getElementById('payLinkInput').value = pay.link||'';
      openModal('walletEditModal');
    }
    function saveWalletMethod() {
      let sec = sections.find(s=>s.key===editingSectionKey);
      let mod = sec.modules[editingModuleIndex];
      let arr = mod.payMethods;
      let obj = {
        title: document.getElementById('payTitleInput').value.trim(),
        rekv: document.getElementById('payRekvInput').value.trim(),
        link: document.getElementById('payLinkInput').value.trim()
      };
      if (editingPayIndex>-1) arr[editingPayIndex] = obj;
      else arr.push(obj);
      saveSections();
      closeModal('walletEditModal');
      renderSection(sec);
    }
    function deletePayMethod(sectionKey,modIndex,payIndex) {
      if (!confirm('–£–¥–∞–ª–∏—Ç—å —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã?')) return;
      let sec = sections.find(s=>s.key===sectionKey);
      let mod = sec.modules[modIndex];
      mod.payMethods.splice(payIndex,1);
      saveSections();
      renderSection(sec);
    }

    // ---- –ö—Ä–æ—à–∫–∏ ----
    function renderBreadcrumbs() {
      let bc = navStack.map((step, i) => `<a href="#" onclick="breadcrumbNav(${i});return false;">${step.title}</a>`).join(' / ');
      document.getElementById('breadcrumbs').innerHTML = bc;
      document.getElementById('breadcrumbs').style.display = 'block';
    }
    function goBack() {
      if (navStack.length > 1) navStack.pop();
      let last = navStack[navStack.length-1];
      last.cb();
    }
    function breadcrumbNav(idx) {
      navStack = navStack.slice(0, idx+1);
      let last = navStack[navStack.length-1];
      last.cb();
    }

    // --- –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã ---
    function copyToClipboard(txt) {
      navigator.clipboard.writeText(txt);
      alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ: ' + txt);
    }

    // --- –Ø–∑—ã–∫, —Ç–µ–º–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ---
    function showLangPanel() {
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('sectionPage').style.display = 'none';
      document.getElementById('langPanel').style.display = 'block';
      document.getElementById('breadcrumbs').style.display = 'none';
      document.getElementById('header').textContent = '–Ø–∑—ã–∫';
    }
    function selectLang(code) {
      alert('–ü–æ–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∏. –í—ã –≤—ã–±—Ä–∞–ª–∏: ' + code.toUpperCase());
      renderMenu();
    }
    function showThemeInfo() {
      alert('–¢–µ–º—ã –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã.');
    }
    function showSettingsInfo() {
      alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã.');
    }

    // ---- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ ----
    function openModal(id) { document.getElementById(id).classList.add('open'); }
    function closeModal(id) { document.getElementById(id).classList.remove('open'); }

    // ---- –°–æ—Ö—Ä–∞–Ω—è–µ–º ----
    function saveSections() { localStorage.setItem('brelynt-sections', JSON.stringify(sections)); }

    // ---- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ----
    renderMenu();
    window.openSection = openSection;
    window.renderMenu = renderMenu;
    window.goBack = goBack;
    window.breadcrumbNav = breadcrumbNav;

  </script>
<script src="../js/p2p.js"></script>
<script>
  startP2P("ws://localhost:9090");
</script></body>
</html>
